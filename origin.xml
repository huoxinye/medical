<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE nta PUBLIC '-//Uppaal Team//DTD Flat System 1.1//EN' 'http://www.it.uu.se/research/group/darts/uppaal/flat-1_2.dtd'>
<nta>
	<declaration>/*************** 初始化***************/
/**结果衡量指标**/
int lost;
/**基本设定**/
const int np=5;//病人人数
const int nn=2; //护士人数
const double hp_p=0.002;//呼吸异常发生概率
const double mp_p=0.002;//血压异常发生频率
const double other_p=0.002;//其他异常发生频率
const double Qday_p=0.002;//问询发生频率
const double Qnight_p=0.001;//问询发生频率
const int incount=2;//输液次数
const int ine=480;//输液时间
const int inl=540;//输液时间
const int inmin=30;//输液时长
const int inmax=60;//输液时长
/**辅助设定**/
typedef int[1,np] id_p;       
typedef int[1,nn] id_n; 
int psn[np];//病人由哪个护士照顾
bool busy[nn];//全忙状态
bool iniac=1;
//bool done[nn];
bool ini[nn],ini1[nn];
clock allclock;
/**护士的状态**/
bool works[nn];//1表示在工作，0表示不在工作
/***************消息定义***************/
/**idp患者输液时间到**/
broadcast chan mess_ins[np+1];
/**idp患者需要继续输液**/
broadcast chan holdon[np+1];
/**idp患者拔针时间到**/
broadcast chan mess_ine[np+1];
/**异常发生频率**/
broadcast chan HPS[np+1];//呼吸异常
broadcast chan MPS[np+1];//血压异常
/**ar自动报警检测设备发出报警信息**/
broadcast chan mess_HP[np+1];//高级
broadcast chan mess_MP[np+1];//中级
/**表示处理状态**/
//bool insneed[np],ineneed[np],holdneed[np],hpneed[np],mpneed[np];//高级
/**中间调度者提醒护士开始工作**/
broadcast chan mess_out[nn+1];
int typectn,numberctn;//相当于传递信息。0表示扎针，1表示拔针，2表示hp,3表示mp
/**idp患者手动叫护士**/
broadcast chan connect[nn+1];
int numberptn,typeptn;
/**护士工作**/
broadcast chan inss[np+1];
broadcast chan inse[np+1];
broadcast chan ines[np+1];
broadcast chan inee[np+1];
broadcast chan hps[np+1];
broadcast chan hpe[np+1];
broadcast chan mps[np+1];
broadcast chan mpe[np+1];
broadcast chan others[np+1];
broadcast chan othere[np+1];
/**重复处理工作提醒**/
broadcast chan repeat[nn+1];
/**护士处理结束**/
broadcast chan over1[np+1];//自动信息处理结束
broadcast chan over[np+1];//任意信息处理结束
/**护士选择好要处理的信息**/
broadcast chan deal[nn+1];
broadcast chan overtalk[np+1];
int numbersts,typests;
/**转接收到的信息**/
broadcast chan transcall;
int numberntn,typentn;
/**护士收到转接信息**/
bool reply[nn];//给出回应
broadcast chan havereply;//告诉其他护士我准备去了你们不要去
bool acntn;</declaration>
	<template>
		<name>BEGIN</name>
		<declaration>void initbusy(){
int i=0;
int j=0;
int k=0;
//初始化病人的看护者
    for (j=1;j&lt;nn;j++){
        for(i=0;i&lt;np/nn;i++)
        {
        psn[k]=j;
        k=k+1;
        }
    };
     while(k&lt;np)
    {
        psn[k]=j;
        k=k+1;
    }
//初始化护士的工作状态对比
    for(i=0;i&lt;nn;i++)
   {
       busy[i]=1;
       ini[i]=1;
       ini1[i]=1;
 //      done[i]=1;
    };
}</declaration>
		<location id="id0" x="-527" y="-484">
			<name x="-537" y="-518">end</name>
		</location>
		<location id="id1" x="-782" y="-484">
			<name x="-792" y="-518">start</name>
			<committed/>
		</location>
		<init ref="id1"/>
		<transition>
			<source ref="id1"/>
			<target ref="id0"/>
			<label kind="assignment" x="-629" y="-484">initbusy()</label>
		</transition>
	</template>
	<template>
		<name x="5" y="5">Mbreath</name>
		<parameter>const id_p idp</parameter>
		<declaration>/**模型的正确性验证指标**/
//int starthp;
int endhp;
/**自动参数设定**/
const int waits=25;
const int waite=30;
/**辅助**/
clock c,incl;</declaration>
		<location id="id2" x="-731" y="-263">
			<name x="-741" y="-297">help1</name>
			<committed/>
		</location>
		<location id="id3" x="-935" y="-263">
			<name x="-945" y="-297">start</name>
		</location>
		<location id="id4" x="-382" y="-263">
			<name x="-390" y="-297">we</name>
		</location>
		<location id="id5" x="-535" y="-263">
			<name x="-552" y="-246">ws</name>
			<label kind="invariant" x="-569" y="-297">incl&lt;=waite</label>
		</location>
		<location id="id6" x="-162" y="-263">
			<name x="-181" y="-297">end</name>
		</location>
		<init ref="id3"/>
		<transition>
			<source ref="id3"/>
			<target ref="id2"/>
			<label kind="synchronisation" x="-850" y="-280">HPS[idp]?</label>
		</transition>
		<transition>
			<source ref="id4"/>
			<target ref="id6"/>
			<label kind="guard" x="-289" y="-289">c&gt;=1440</label>
			<label kind="synchronisation" x="-314" y="-255">hpe[idp]?</label>
			<label kind="assignment" x="-238" y="-255">endhp++</label>
			<nail x="-280" y="-263"/>
		</transition>
		<transition>
			<source ref="id4"/>
			<target ref="id3"/>
			<label kind="guard" x="-578" y="-212">c&lt;1440</label>
			<label kind="synchronisation" x="-569" y="-186">hpe[idp]?</label>
			<label kind="assignment" x="-713" y="-207">endhp++</label>
			<nail x="-382" y="-152"/>
		</transition>
		<transition>
			<source ref="id2"/>
			<target ref="id5"/>
			<label kind="guard" x="-671" y="-305">iniac==1</label>
			<label kind="synchronisation" x="-688" y="-288">mess_HP[idp]!</label>
			<label kind="assignment" x="-671" y="-263">incl=0</label>
		</transition>
		<transition>
			<source ref="id5"/>
			<target ref="id4"/>
			<label kind="synchronisation" x="-476" y="-288">hps[idp]?</label>
		</transition>
		<transition>
			<source ref="id5"/>
			<target ref="id5"/>
			<label kind="guard" x="-586" y="-390">incl&gt;=waits&amp;&amp;iniac==1</label>
			<label kind="synchronisation" x="-569" y="-365">mess_HP[idp]!</label>
			<label kind="assignment" x="-552" y="-348">incl=0</label>
			<nail x="-587" y="-365"/>
			<nail x="-476" y="-365"/>
		</transition>
	</template>
	<template>
		<name>Pbreath</name>
		<parameter>const id_p idp</parameter>
		<declaration>/**模型的正确性验证指标**/
int starthp;
int endhp;
/**自动参数设定**/
const int php=5;
const int waits=25;
const int waite=30;
const int delays=5;
const int delaye=8;
/**辅助**/
clock cl,c;</declaration>
		<location id="id7" x="-518" y="-663">
			<name x="-527" y="-705">jws</name>
		</location>
		<location id="id8" x="-272" y="-510">
			<name x="-282" y="-544">we</name>
		</location>
		<location id="id9" x="-790" y="-365">
			<name x="-800" y="-399">decide</name>
			<label kind="invariant" x="-816" y="-348">cl&lt;=delaye</label>
		</location>
		<location id="id10" x="-527" y="-365">
			<name x="-537" y="-399">help</name>
			<committed/>
		</location>
		<location id="id11" x="-527" y="-510">
			<name x="-510" y="-535">ws</name>
			<label kind="invariant" x="-510" y="-501">cl&lt;=waite</label>
		</location>
		<location id="id12" x="-952" y="-365">
			<name x="-962" y="-399">start</name>
			<label kind="exponentialrate" x="-969" y="-340">hp_p</label>
		</location>
		<branchpoint id="id13" x="-688" y="-365">
		</branchpoint>
		<init ref="id12"/>
		<transition>
			<source ref="id7"/>
			<target ref="id8"/>
			<label kind="synchronisation" x="-391" y="-603">hps[idp]?</label>
		</transition>
		<transition>
			<source ref="id10"/>
			<target ref="id8"/>
			<label kind="synchronisation" x="-493" y="-365">hps[idp]?</label>
			<nail x="-502" y="-365"/>
			<nail x="-442" y="-365"/>
		</transition>
		<transition>
			<source ref="id11"/>
			<target ref="id8"/>
			<label kind="synchronisation" x="-433" y="-535">hps[idp]?</label>
		</transition>
		<transition>
			<source ref="id11"/>
			<target ref="id11"/>
			<label kind="guard" x="-620" y="-595">cl&gt;=waits&amp;&amp;ini[psn[idp-1]-1]</label>
			<label kind="synchronisation" x="-594" y="-569">connect[psn[idp-1]]!</label>
			<label kind="assignment" x="-604" y="-552">typeptn=2,numberptn=idp,cl=0</label>
			<nail x="-527" y="-535"/>
			<nail x="-536" y="-578"/>
			<nail x="-612" y="-527"/>
		</transition>
		<transition>
			<source ref="id9"/>
			<target ref="id8"/>
			<label kind="synchronisation" x="-552" y="-314">hps[idp]?</label>
			<nail x="-790" y="-289"/>
			<nail x="-417" y="-289"/>
		</transition>
		<transition>
			<source ref="id9"/>
			<target ref="id13"/>
			<label kind="guard" x="-773" y="-391">cl&gt;=delays</label>
			<label kind="assignment" x="-756" y="-365">cl=0</label>
		</transition>
		<transition>
			<source ref="id10"/>
			<target ref="id11"/>
			<label kind="guard" x="-569" y="-476">ini[psn[idp-1]-1]</label>
			<label kind="synchronisation" x="-578" y="-450">connect[psn[idp-1]]!</label>
			<label kind="assignment" x="-595" y="-425">typeptn=2,numberptn=idp</label>
		</transition>
		<transition>
			<source ref="id13"/>
			<target ref="id10"/>
			<label kind="probability" x="-629" y="-365">php</label>
		</transition>
		<transition>
			<source ref="id13"/>
			<target ref="id7"/>
			<label kind="probability" x="-705" y="-476">10-php</label>
			<nail x="-688" y="-663"/>
		</transition>
		<transition>
			<source ref="id8"/>
			<target ref="id12"/>
			<label kind="synchronisation" x="-561" y="-238">hpe[idp]?</label>
			<label kind="assignment" x="-373" y="-378">endhp++</label>
			<nail x="-391" y="-246"/>
			<nail x="-926" y="-246"/>
		</transition>
		<transition>
			<source ref="id12"/>
			<target ref="id9"/>
			<label kind="synchronisation" x="-901" y="-391">HPS[idp]!</label>
			<label kind="assignment" x="-918" y="-365">cl=0,starthp++</label>
		</transition>
	</template>
	<template>
		<name>Mblood</name>
		<parameter>const id_p idp</parameter>
		<declaration>/**模型的正确性验证指标**/
//int startmp;
int endmp;
/**自动参数设定**/
const int waits=25;
const int waite=30;
/**辅助**/
clock c,incl;</declaration>
		<location id="id14" x="-263" y="102">
			<name x="-273" y="68">help1</name>
			<committed/>
		</location>
		<location id="id15" x="59" y="102">
			<name x="49" y="68">we</name>
		</location>
		<location id="id16" x="-374" y="102">
			<name x="-391" y="68">start</name>
		</location>
		<location id="id17" x="-77" y="102">
			<name x="-102" y="59">ws</name>
			<label kind="invariant" x="-110" y="110">incl&lt;=waite</label>
		</location>
		<location id="id18" x="306" y="102">
			<name x="296" y="68">end</name>
		</location>
		<init ref="id16"/>
		<transition>
			<source ref="id16"/>
			<target ref="id14"/>
			<label kind="synchronisation" x="-356" y="85">MPS[idp]?</label>
		</transition>
		<transition>
			<source ref="id17"/>
			<target ref="id15"/>
			<label kind="synchronisation" x="-26" y="77">mps[idp]?</label>
		</transition>
		<transition>
			<source ref="id15"/>
			<target ref="id18"/>
			<label kind="guard" x="170" y="102">c&gt;=1440</label>
			<label kind="synchronisation" x="85" y="76">mpe[idp]?</label>
			<label kind="assignment" x="93" y="102">endmp++</label>
		</transition>
		<transition>
			<source ref="id15"/>
			<target ref="id16"/>
			<label kind="guard" x="-254" y="131">c&lt;1440</label>
			<label kind="synchronisation" x="-85" y="204">mpe[idp]?</label>
			<label kind="assignment" x="-136" y="161">endmp++</label>
			<nail x="59" y="229"/>
		</transition>
		<transition>
			<source ref="id14"/>
			<target ref="id17"/>
			<label kind="guard" x="-144" y="76">iniac==1</label>
			<label kind="synchronisation" x="-238" y="76">mess_MP[idp]!</label>
			<label kind="assignment" x="-187" y="102">incl=0</label>
		</transition>
		<transition>
			<source ref="id17"/>
			<target ref="id17"/>
			<label kind="guard" x="-136" y="-17">incl&gt;=waits&amp;&amp;iniac==1</label>
			<label kind="synchronisation" x="-119" y="0">mess_HP[idp]!</label>
			<label kind="assignment" x="-93" y="17">incl=0</label>
			<nail x="-129" y="0"/>
			<nail x="-18" y="0"/>
		</transition>
	</template>
	<template>
		<name>Pblood</name>
		<parameter>const id_p idp</parameter>
		<declaration>/**模型的正确性验证指标**/
int startmp;
int endmp;
/**自动参数设定**/
const int pmp=5;
const int waits=25;
const int waite=30;
const int delays=5;
const int delaye=8;
/**辅助**/
clock cl,c;</declaration>
		<location id="id19" x="-365" y="-646">
			<name x="-375" y="-680">jws</name>
		</location>
		<location id="id20" x="-221" y="-476">
			<name x="-231" y="-510">we</name>
		</location>
		<location id="id21" x="-577" y="-332">
			<name x="-587" y="-366">decide</name>
			<label kind="invariant" x="-594" y="-315">cl&lt;=delaye</label>
		</location>
		<location id="id22" x="-314" y="-332">
			<name x="-324" y="-366">help</name>
			<committed/>
		</location>
		<location id="id23" x="-314" y="-476">
			<name x="-324" y="-510">ws</name>
			<label kind="invariant" x="-340" y="-459">cl&lt;=waite</label>
		</location>
		<location id="id24" x="-713" y="-332">
			<name x="-723" y="-366">start</name>
			<label kind="exponentialrate" x="-731" y="-314">mp_p</label>
		</location>
		<branchpoint id="id25" x="-483" y="-332">
		</branchpoint>
		<init ref="id24"/>
		<transition>
			<source ref="id19"/>
			<target ref="id20"/>
			<label kind="synchronisation" x="-306" y="-603">mps[idp]?</label>
		</transition>
		<transition>
			<source ref="id22"/>
			<target ref="id20"/>
			<label kind="synchronisation" x="-289" y="-348">mps[idp]?</label>
			<nail x="-246" y="-331"/>
		</transition>
		<transition>
			<source ref="id23"/>
			<target ref="id20"/>
			<label kind="synchronisation" x="-296" y="-493">mps[idp]?</label>
		</transition>
		<transition>
			<source ref="id21"/>
			<target ref="id20"/>
			<label kind="synchronisation" x="-382" y="-289">mps[idp]?</label>
			<nail x="-577" y="-272"/>
			<nail x="-221" y="-272"/>
		</transition>
		<transition>
			<source ref="id21"/>
			<target ref="id25"/>
			<label kind="guard" x="-569" y="-357">cl&gt;=delaye</label>
			<label kind="assignment" x="-559" y="-332">cl=0</label>
		</transition>
		<transition>
			<source ref="id22"/>
			<target ref="id23"/>
			<label kind="guard" x="-314" y="-438">ini[psn[idp-1]-1]</label>
			<label kind="synchronisation" x="-374" y="-408">connect[psn[idp-1]]!</label>
			<label kind="assignment" x="-416" y="-382">typeptn=3,numberptn=idp,cl=0</label>
		</transition>
		<transition>
			<source ref="id25"/>
			<target ref="id22"/>
			<label kind="probability" x="-442" y="-331">pmp</label>
		</transition>
		<transition>
			<source ref="id25"/>
			<target ref="id19"/>
			<label kind="probability" x="-493" y="-416">10-pmp</label>
			<nail x="-484" y="-646"/>
		</transition>
		<transition>
			<source ref="id20"/>
			<target ref="id24"/>
			<label kind="synchronisation" x="-467" y="-221">mpe[idp]?</label>
			<label kind="assignment" x="-391" y="-221">endmp++</label>
			<nail x="-178" y="-195"/>
			<nail x="-714" y="-195"/>
		</transition>
		<transition>
			<source ref="id24"/>
			<target ref="id21"/>
			<label kind="synchronisation" x="-680" y="-357">MPS[idp]!</label>
			<label kind="assignment" x="-697" y="-331">cl=0,startmp++</label>
		</transition>
		<transition>
			<source ref="id23"/>
			<target ref="id23"/>
			<label kind="guard" x="-425" y="-561">cl&gt;=waits&amp;&amp;ini[psn[idp-1]-1]</label>
			<label kind="synchronisation" x="-450" y="-544">connect[psn[idp-1]]!</label>
			<label kind="assignment" x="-459" y="-527">typeptn=3,numberptn=idp,cl=0</label>
			<nail x="-357" y="-569"/>
			<nail x="-433" y="-518"/>
			<nail x="-374" y="-493"/>
		</transition>
	</template>
	<template>
		<name>Minject</name>
		<parameter>const id_p idp</parameter>
		<declaration>/**模型的正确性验证指标**/
int startins;
int endins;
/**病人基本信息设定**/
const int waits=25;
const int waite=30;
/**辅助**/
clock incl,c;
int ii=0;</declaration>
		<location id="id26" x="-5523" y="-3961">
			<name x="-5533" y="-3995">end</name>
		</location>
		<location id="id27" x="-5703" y="-3961">
			<name x="-5712" y="-3995">help</name>
			<committed/>
		</location>
		<location id="id28" x="-5797" y="-3961">
			<name x="-5822" y="-3995">wait2e</name>
		</location>
		<location id="id29" x="-6018" y="-3961">
			<name x="-6026" y="-3995">on</name>
			<label kind="invariant" x="-6060" y="-3944">incl&lt;=inmax</label>
		</location>
		<location id="id30" x="-6154" y="-3961">
			<name x="-6171" y="-3995">wait1e</name>
		</location>
		<location id="id31" x="-6290" y="-3961">
			<name x="-6307" y="-3995">wait1s</name>
			<label kind="invariant" x="-6324" y="-3944">incl&lt;=waite</label>
		</location>
		<location id="id32" x="-6536" y="-3961">
			<name x="-6546" y="-3995">start</name>
			<label kind="invariant" x="-6561" y="-3944">incl&lt;=inl</label>
		</location>
		<location id="id33" x="-5890" y="-3961">
			<name x="-5907" y="-3952">wait2s</name>
			<label kind="invariant" x="-5916" y="-3935">incl&lt;=waite</label>
		</location>
		<location id="id34" x="-6400" y="-4139">
			<name x="-6425" y="-4173">waithold</name>
			<label kind="invariant" x="-6434" y="-4131">incl&lt;=waite</label>
		</location>
		<init ref="id32"/>
		<transition>
			<source ref="id31"/>
			<target ref="id31"/>
			<label kind="guard" x="-6341" y="-3927">incl&gt;=waits&amp;&amp;iniac==1</label>
			<label kind="synchronisation" x="-6332" y="-3910">mess_ins[idp]!</label>
			<label kind="assignment" x="-6324" y="-3893">incl=0</label>
			<nail x="-6358" y="-3893"/>
			<nail x="-6222" y="-3893"/>
		</transition>
		<transition>
			<source ref="id29"/>
			<target ref="id28"/>
			<label kind="synchronisation" x="-5941" y="-3884">ines[idp]?</label>
			<nail x="-5984" y="-3850"/>
			<nail x="-5856" y="-3850"/>
		</transition>
		<transition>
			<source ref="id32"/>
			<target ref="id30"/>
			<label kind="synchronisation" x="-6324" y="-3859">inss[idp]?</label>
			<nail x="-6434" y="-3859"/>
			<nail x="-6205" y="-3859"/>
		</transition>
		<transition>
			<source ref="id27"/>
			<target ref="id26"/>
			<label kind="guard" x="-5652" y="-3961">ii&gt;=incount</label>
		</transition>
		<transition>
			<source ref="id28"/>
			<target ref="id27"/>
			<label kind="synchronisation" x="-5780" y="-3978">inee[idp]?</label>
			<label kind="assignment" x="-5797" y="-3961">ii++,endins++</label>
		</transition>
		<transition>
			<source ref="id33"/>
			<target ref="id28"/>
			<label kind="synchronisation" x="-5873" y="-3978">ines[idp]?</label>
		</transition>
		<transition>
			<source ref="id29"/>
			<target ref="id33"/>
			<label kind="guard" x="-6043" y="-3986">incl&gt;=inmin&amp;&amp;iniac==1</label>
			<label kind="synchronisation" x="-6009" y="-3961">mess_ine[idp]!</label>
			<label kind="assignment" x="-6069" y="-3927">incl=0</label>
		</transition>
		<transition>
			<source ref="id27"/>
			<target ref="id34"/>
			<label kind="guard" x="-6009" y="-4165">ii&lt;incount&amp;&amp;iniac==1</label>
			<label kind="synchronisation" x="-6043" y="-4139">holdon[idp]!</label>
			<label kind="assignment" x="-5958" y="-4139">incl=0</label>
			<nail x="-5703" y="-4139"/>
		</transition>
		<transition>
			<source ref="id30"/>
			<target ref="id29"/>
			<label kind="synchronisation" x="-6120" y="-3986">inse[idp]?</label>
			<label kind="assignment" x="-6137" y="-3961">incl=0,startins++</label>
		</transition>
		<transition>
			<source ref="id31"/>
			<target ref="id30"/>
			<label kind="synchronisation" x="-6247" y="-3986">inss[idp]?</label>
		</transition>
		<transition>
			<source ref="id32"/>
			<target ref="id31"/>
			<label kind="guard" x="-6485" y="-3986">incl&gt;=ine&amp;&amp;iniac==1</label>
			<label kind="synchronisation" x="-6468" y="-3961">mess_ins[idp]!</label>
			<label kind="assignment" x="-6494" y="-3944">incl=0</label>
		</transition>
		<transition>
			<source ref="id33"/>
			<target ref="id33"/>
			<label kind="guard" x="-5967" y="-4080">incl&gt;=waits&amp;&amp;iniac==1</label>
			<label kind="synchronisation" x="-5941" y="-4054">mess_ine[idp]!</label>
			<label kind="assignment" x="-5907" y="-4038">incl=0</label>
			<nail x="-5967" y="-4054"/>
			<nail x="-5822" y="-4054"/>
		</transition>
		<transition>
			<source ref="id34"/>
			<target ref="id34"/>
			<label kind="guard" x="-6468" y="-4105">incl&gt;=waits&amp;&amp;iniac==1</label>
			<label kind="synchronisation" x="-6443" y="-4088">holdon[idp]!</label>
			<label kind="assignment" x="-6425" y="-4071">incl=0</label>
			<nail x="-6468" y="-4071"/>
			<nail x="-6349" y="-4071"/>
		</transition>
		<transition>
			<source ref="id34"/>
			<target ref="id30"/>
			<label kind="synchronisation" x="-6213" y="-4088">inss[idp]?</label>
			<nail x="-6205" y="-4114"/>
		</transition>
	</template>
	<template>
		<name>Pinject</name>
		<parameter>const id_p idp</parameter>
		<declaration>/**模型的正确性验证指标**/
int startins;
int endins;
/**病人基本信息设定**/
const int pins=5,pine=5,pcon=5;//发出警报的概率
const int waits=25;
const int waite=30;
/**辅助**/
clock cl,c;
int api;</declaration>
		<location id="id35" x="-6086" y="-3910">
			<name x="-6094" y="-3944">jw2s</name>
		</location>
		<location id="id36" x="-6417" y="-3884">
			<name x="-6427" y="-3918">jw1s</name>
		</location>
		<location id="id37" x="-6596" y="-3791">
			<name x="-6606" y="-3825">help1</name>
			<committed/>
		</location>
		<location id="id38" x="-5652" y="-3791">
			<name x="-5660" y="-3774">help3</name>
		</location>
		<location id="id39" x="-5754" y="-3791">
			<name x="-5764" y="-3825">wait2e</name>
		</location>
		<location id="id40" x="-6137" y="-3791">
			<name x="-6147" y="-3825">on</name>
			<label kind="invariant" x="-6163" y="-3774">cl&lt;=inmax</label>
		</location>
		<location id="id41" x="-6298" y="-3791">
			<name x="-6315" y="-3833">wait1e</name>
		</location>
		<location id="id42" x="-6757" y="-3791">
			<name x="-6767" y="-3825">start</name>
			<label kind="invariant" x="-6782" y="-3774">cl&lt;=inl</label>
		</location>
		<location id="id43" x="-6036" y="-3791">
			<name x="-6046" y="-3825">help2</name>
			<committed/>
		</location>
		<location id="id44" x="-6409" y="-3791">
			<name x="-6419" y="-3825">wait1s</name>
			<label kind="invariant" x="-6392" y="-3782">cl&lt;=waite</label>
		</location>
		<location id="id45" x="-5839" y="-3791">
			<name x="-5849" y="-3825">wait2s</name>
			<label kind="invariant" x="-5873" y="-3774">cl&lt;=waite</label>
		</location>
		<location id="id46" x="-6443" y="-4020">
			<name x="-6453" y="-4054">waithold</name>
			<label kind="invariant" x="-6477" y="-4003">cl&lt;=waite</label>
		</location>
		<branchpoint id="id47" x="-6647" y="-3791">
		</branchpoint>
		<branchpoint id="id48" x="-6086" y="-3791">
		</branchpoint>
		<init ref="id42"/>
		<transition>
			<source ref="id38"/>
			<target ref="id46"/>
			<label kind="synchronisation" x="-5933" y="-4045">holdon[idp]?</label>
			<label kind="assignment" x="-6043" y="-4045">cl=0</label>
			<nail x="-5652" y="-4020"/>
		</transition>
		<transition>
			<source ref="id35"/>
			<target ref="id39"/>
			<label kind="synchronisation" x="-5950" y="-3884">ines[idp]?</label>
			<nail x="-5763" y="-3910"/>
		</transition>
		<transition>
			<source ref="id36"/>
			<target ref="id41"/>
			<label kind="synchronisation" x="-6400" y="-3859">inss[idp]?</label>
		</transition>
		<transition>
			<source ref="id46"/>
			<target ref="id41"/>
			<label kind="synchronisation" x="-6282" y="-3893">inss[idp]?</label>
			<nail x="-6298" y="-3892"/>
		</transition>
		<transition>
			<source ref="id47"/>
			<target ref="id36"/>
			<label kind="assignment" x="-6621" y="-3854">cl=0</label>
			<label kind="probability" x="-6690" y="-3859">10-pins</label>
			<nail x="-6545" y="-3884"/>
		</transition>
		<transition>
			<source ref="id47"/>
			<target ref="id37"/>
			<label kind="probability" x="-6638" y="-3808">pins</label>
		</transition>
		<transition>
			<source ref="id42"/>
			<target ref="id47"/>
			<label kind="guard" x="-6732" y="-3808">cl&gt;=ine</label>
		</transition>
		<transition>
			<source ref="id40"/>
			<target ref="id39"/>
			<label kind="synchronisation" x="-5899" y="-3646">ines[idp]?</label>
			<nail x="-6137" y="-3655"/>
			<nail x="-5754" y="-3655"/>
		</transition>
		<transition>
			<source ref="id42"/>
			<target ref="id41"/>
			<label kind="synchronisation" x="-6528" y="-3655">inss[idp]?</label>
			<nail x="-6681" y="-3638"/>
			<nail x="-6366" y="-3638"/>
		</transition>
		<transition>
			<source ref="id39"/>
			<target ref="id38"/>
			<label kind="synchronisation" x="-5729" y="-3808">inee[idp]?</label>
			<label kind="assignment" x="-5746" y="-3782">api++,cl=0,endins++</label>
		</transition>
		<transition>
			<source ref="id45"/>
			<target ref="id39"/>
			<label kind="synchronisation" x="-5832" y="-3808">ines[idp]?</label>
		</transition>
		<transition>
			<source ref="id43"/>
			<target ref="id45"/>
			<label kind="guard" x="-6001" y="-3774">ini[psn[idp-1]-1]</label>
			<label kind="synchronisation" x="-6010" y="-3816">connect[psn[idp-1]]!</label>
			<label kind="assignment" x="-6035" y="-3791">typeptn=1,numberptn=idp,cl=0</label>
		</transition>
		<transition>
			<source ref="id41"/>
			<target ref="id40"/>
			<label kind="synchronisation" x="-6247" y="-3808">inse[idp]?</label>
			<label kind="assignment" x="-6264" y="-3782">cl=0,startins++</label>
		</transition>
		<transition>
			<source ref="id44"/>
			<target ref="id41"/>
			<label kind="synchronisation" x="-6366" y="-3816">inss[idp]?</label>
		</transition>
		<transition>
			<source ref="id37"/>
			<target ref="id44"/>
			<label kind="guard" x="-6553" y="-3833">ini[psn[idp-1]-1]</label>
			<label kind="synchronisation" x="-6570" y="-3791">connect[psn[idp-1]]!</label>
			<label kind="assignment" x="-6587" y="-3816">typeptn=0,numberptn=idp,cl=0</label>
			<nail x="-6434" y="-3791"/>
		</transition>
		<transition>
			<source ref="id48"/>
			<target ref="id35"/>
			<label kind="assignment" x="-6094" y="-3850">cl=0</label>
			<label kind="probability" x="-6103" y="-3867">10-pine</label>
		</transition>
		<transition>
			<source ref="id48"/>
			<target ref="id43"/>
			<label kind="probability" x="-6078" y="-3817">pine</label>
		</transition>
		<transition>
			<source ref="id40"/>
			<target ref="id48"/>
			<label kind="guard" x="-6129" y="-3834">cl&gt;=inmin</label>
		</transition>
		<transition>
			<source ref="id44"/>
			<target ref="id44"/>
			<label kind="guard" x="-6502" y="-3740">cl&gt;=waits&amp;&amp;ini[psn[idp-1]-1]</label>
			<label kind="synchronisation" x="-6478" y="-3723">connect[psn[idp-1]]!</label>
			<label kind="assignment" x="-6503" y="-3706">typeptn=0,numberptn=idp,cl=0</label>
			<nail x="-6358" y="-3706"/>
			<nail x="-6477" y="-3706"/>
		</transition>
		<transition>
			<source ref="id45"/>
			<target ref="id45"/>
			<label kind="guard" x="-5941" y="-3723">cl&gt;=waits&amp;&amp;ini[psn[idp-1]-1]</label>
			<label kind="synchronisation" x="-5899" y="-3757">connect[psn[idp-1]]!</label>
			<label kind="assignment" x="-5966" y="-3740">typeptn=1,numberptn=idp,cl=0</label>
			<nail x="-5813" y="-3740"/>
			<nail x="-5889" y="-3740"/>
		</transition>
		<transition>
			<source ref="id46"/>
			<target ref="id46"/>
			<label kind="guard" x="-6536" y="-3969">cl&gt;=waits&amp;&amp;ini[psn[idp-1]-1]</label>
			<label kind="synchronisation" x="-6511" y="-3952">connect[psn[idp-1]]!</label>
			<label kind="assignment" x="-6537" y="-3935">typeptn=0,numberptn=idp,cl=0</label>
			<nail x="-6392" y="-3935"/>
			<nail x="-6511" y="-3935"/>
		</transition>
	</template>
	<template>
		<name>Purgent</name>
		<parameter>const id_p idp</parameter>
		<declaration>/**模型的正确性验证指标**/
int startother;
int endother;
/**初始化设定**/
const int waits=25;
const int waite=30;
/**辅助**/
clock cl,c;</declaration>
		<location id="id49" x="-1759" y="-1734">
			<name x="-1769" y="-1768">we</name>
		</location>
		<location id="id50" x="-2278" y="-1734">
			<name x="-2287" y="-1768">start</name>
			<label kind="exponentialrate" x="-2261" y="-1708">other_p</label>
		</location>
		<location id="id51" x="-1895" y="-1734">
			<name x="-1905" y="-1768">ws</name>
			<label kind="invariant" x="-1920" y="-1717">cl&lt;=waite</label>
		</location>
		<location id="id52" x="-1589" y="-1734">
			<name x="-1599" y="-1768">end</name>
		</location>
		<init ref="id50"/>
		<transition>
			<source ref="id51"/>
			<target ref="id49"/>
			<label kind="synchronisation" x="-1861" y="-1759">others[idp]?</label>
		</transition>
		<transition>
			<source ref="id49"/>
			<target ref="id52"/>
			<label kind="guard" x="-1700" y="-1776">c&gt;=1440</label>
			<label kind="synchronisation" x="-1708" y="-1734">othere[idp]?</label>
			<label kind="assignment" x="-1708" y="-1708">endother++</label>
		</transition>
		<transition>
			<source ref="id49"/>
			<target ref="id50"/>
			<label kind="guard" x="-2269" y="-1641">c&lt;1440</label>
			<label kind="synchronisation" x="-2184" y="-1641">othere[idp]?</label>
			<label kind="assignment" x="-2065" y="-1641">endother++</label>
			<nail x="-1759" y="-1649"/>
			<nail x="-2278" y="-1649"/>
		</transition>
		<transition>
			<source ref="id50"/>
			<target ref="id51"/>
			<label kind="guard" x="-2210" y="-1768">psn[idp-1]!=0&amp;&amp;ini[psn[idp-1]-1]</label>
			<label kind="synchronisation" x="-2193" y="-1785">connect[psn[idp-1]]!</label>
			<label kind="assignment" x="-2236" y="-1751">numberptn=idp,typeptn=4,cl=0,startother++</label>
		</transition>
		<transition>
			<source ref="id51"/>
			<target ref="id51"/>
			<label kind="guard" x="-2005" y="-1828">cl&gt;=waits&amp;&amp;ini[psn[idp-1]-1]</label>
			<label kind="synchronisation" x="-2013" y="-1801">connect[psn[idp-1]]!</label>
			<label kind="assignment" x="-2014" y="-1784">typeptn=4,numberptn=idp,cl=0</label>
			<nail x="-1827" y="-1802"/>
			<nail x="-2014" y="-1802"/>
		</transition>
	</template>
	<template>
		<name>Pask</name>
		<parameter>const id_p idp</parameter>
		<declaration>/**模型的正确性验证指标**/
int startask;
int endask;
/**辅助**/
clock cl,c;</declaration>
		<location id="id53" x="-2388" y="-2099">
			<name x="-2398" y="-2133">end</name>
		</location>
		<location id="id54" x="-1742" y="-1963">
			<name x="-1752" y="-1997">help</name>
		</location>
		<location id="id55" x="-2014" y="-1938">
			<name x="-2031" y="-1972">ddecide</name>
			<label kind="exponentialrate" x="-2040" y="-1921">Qday_p</label>
		</location>
		<location id="id56" x="-2014" y="-2024">
			<name x="-2040" y="-2065">ndecide</name>
			<label kind="exponentialrate" x="-2031" y="-2006">Qnight_p</label>
		</location>
		<location id="id57" x="-2388" y="-1981">
			<name x="-2398" y="-2015">start</name>
			<urgent/>
		</location>
		<init ref="id57"/>
		<transition>
			<source ref="id54"/>
			<target ref="id57"/>
			<label kind="guard" x="-2099" y="-1861">c&lt;1440</label>
			<label kind="synchronisation" x="-2091" y="-1887">overtalk[idp]?</label>
			<label kind="assignment" x="-2031" y="-1861">endask++</label>
			<nail x="-1742" y="-1870"/>
			<nail x="-2388" y="-1870"/>
		</transition>
		<transition>
			<source ref="id54"/>
			<target ref="id53"/>
			<label kind="guard" x="-2057" y="-2116">c&gt;=1440</label>
			<label kind="synchronisation" x="-1938" y="-2116">overtalk[idp]?</label>
			<label kind="assignment" x="-2370" y="-2099">endask++</label>
			<nail x="-1742" y="-2099"/>
		</transition>
		<transition>
			<source ref="id55"/>
			<target ref="id54"/>
			<label kind="guard" x="-2004" y="-1985">ini[psn[idp-1]-1]</label>
			<label kind="synchronisation" x="-1971" y="-1946">connect[psn[idp-1]]!</label>
			<label kind="assignment" x="-1980" y="-1929">numberptn=idp,typeptn=5,cl=0,startask++</label>
		</transition>
		<transition>
			<source ref="id57"/>
			<target ref="id56"/>
			<label kind="guard" x="-2286" y="-2006">c&gt;1200&amp;&amp;c&lt;1440</label>
			<nail x="-2057" y="-1981"/>
		</transition>
		<transition>
			<source ref="id57"/>
			<target ref="id56"/>
			<label kind="guard" x="-2269" y="-2049">c&gt;=0&amp;&amp;c&lt;480</label>
			<nail x="-2346" y="-2031"/>
		</transition>
		<transition>
			<source ref="id57"/>
			<target ref="id55"/>
			<label kind="guard" x="-2278" y="-1955">c&gt;=480&amp;&amp;c&lt;=1200</label>
			<nail x="-2354" y="-1939"/>
		</transition>
		<transition>
			<source ref="id56"/>
			<target ref="id54"/>
			<label kind="guard" x="-1938" y="-2014">ini[psn[idp-1]-1]</label>
			<label kind="synchronisation" x="-1955" y="-2048">connect[psn[idp-1]]!</label>
			<label kind="assignment" x="-1972" y="-2031">numberptn=idp,typeptn=5,cl=0,startask++</label>
		</transition>
	</template>
	<template>
		<name>AC</name>
		<declaration>//每个护士没有固定负责的病人，随机选择谁有空谁就负责。
/**参数设定**/
const int waittime[7]={5,4,8,1,0,0,0};//信息存活时间设定
/**结果衡量指标**/
int havedealsum;//处理的消息总数
int nodeal;
/**辅助**/
int nquene[6*np];//存放患者
int tquene[6*np];//存放类型
clock time[6*np];//存放等待时间
int tail=0;//表示队尾位置
int deadtime[7]={5,4,8,1,0,0,0};//信息存活时间设定
int paitent,rank,i,j=0,n;
int i1;
void change(int p,int rank)
{
int i,j;
for(i=0;i&lt;tail;i++)
    {
     if (nquene[i]==p and tquene[i]==rank)
        {
            deadtime[rank]=deadtime[rank]/2;
            for(j=i;j&lt;tail;j++)
            {
            nquene[i]=nquene[i+1];
            tquene[i]=tquene[i+1];
            nodeal=nodeal+1;
            }
        tail=tail-1;
        }   
    }
}
void inquene(int i)
{
nquene[i]=paitent;
tquene[i]=rank;
time[i]=0;
tail=tail+1;
}
void outquene()
{
deadtime[typectn]=waittime[typectn];
havedealsum++;
nquene[tail-1]=0;
tquene[tail-1]=0;
tail--;
}
</declaration>
		<location id="id58" x="-37791" y="-510">
			<name x="-37808" y="-484">help2</name>
			<committed/>
		</location>
		<location id="id59" x="-37757" y="-629">
			<name x="-37767" y="-663">help3</name>
			<committed/>
		</location>
		<location id="id60" x="-37136" y="-510">
			<name x="-37146" y="-544">out</name>
			<committed/>
		</location>
		<location id="id61" x="-37366" y="-510">
			<name x="-37383" y="-544">help4</name>
			<committed/>
		</location>
		<location id="id62" x="-37723" y="-510">
			<name x="-37740" y="-544">in</name>
			<committed/>
		</location>
		<location id="id63" x="-37272" y="-510">
			<name x="-37282" y="-544">decide</name>
			<committed/>
		</location>
		<location id="id64" x="-37901" y="-510">
			<name x="-37918" y="-484">help1</name>
			<committed/>
		</location>
		<location id="id65" x="-38156" y="-510">
			<name x="-38166" y="-544">start</name>
		</location>
		<init ref="id65"/>
		<transition>
			<source ref="id58"/>
			<target ref="id62"/>
			<label kind="guard" x="-37782" y="-544">tail!=0</label>
			<label kind="assignment" x="-37774" y="-510">i=tail</label>
			<nail x="-37757" y="-510"/>
		</transition>
		<transition>
			<source ref="id58"/>
			<target ref="id59"/>
			<label kind="guard" x="-37774" y="-607">tail==0</label>
		</transition>
		<transition>
			<source ref="id64"/>
			<target ref="id59"/>
			<label kind="guard" x="-37884" y="-595">tail==0</label>
		</transition>
		<transition>
			<source ref="id64"/>
			<target ref="id58"/>
			<label kind="guard" x="-37859" y="-552">tail!=0</label>
			<label kind="assignment" x="-37901" y="-501">change(paitent,rank)</label>
		</transition>
		<transition>
			<source ref="id60"/>
			<target ref="id65"/>
			<label kind="guard" x="-37935" y="-791">tail&gt;0&amp;&amp;!works[psn[nquene[tail-1]-1]-1]&amp;&amp;ini[psn[nquene[tail-1]-1]-1]</label>
			<label kind="synchronisation" x="-37859" y="-765">mess_out[psn[nquene[tail-1]-1]]!</label>
			<label kind="assignment" x="-37544" y="-765">typectn=tquene[tail-1],numberctn=nquene[tail-1],outquene(),iniac=1</label>
			<nail x="-37068" y="-740"/>
			<nail x="-38139" y="-740"/>
		</transition>
		<transition>
			<source ref="id65"/>
			<target ref="id63"/>
			<label kind="select" x="-37706" y="-433">e:id_p</label>
			<label kind="synchronisation" x="-37629" y="-433">over1[e]?</label>
			<label kind="assignment" x="-37697" y="-408">iniac=0</label>
			<nail x="-38071" y="-408"/>
			<nail x="-37323" y="-408"/>
		</transition>
		<transition>
			<source ref="id60"/>
			<target ref="id65"/>
			<label kind="guard" x="-37655" y="-357">tail==0</label>
			<label kind="assignment" x="-38020" y="-357">iniac=1</label>
			<nail x="-37136" y="-340"/>
			<nail x="-38122" y="-340"/>
		</transition>
		<transition>
			<source ref="id60"/>
			<target ref="id65"/>
			<label kind="guard" x="-37833" y="-723">tail&gt;0&amp;&amp;works[psn[nquene[tail-1]-1]-1]</label>
			<label kind="synchronisation" x="-37952" y="-723">mess_out[n]!</label>
			<label kind="assignment" x="-37578" y="-723">typectn=tquene[tail-1],numberctn=nquene[tail-1],outquene(),iniac=1</label>
			<nail x="-37170" y="-697"/>
			<nail x="-38097" y="-697"/>
		</transition>
		<transition>
			<source ref="id63"/>
			<target ref="id65"/>
			<label kind="guard" x="-37672" y="-382">works==busy</label>
			<label kind="assignment" x="-38020" y="-382">iniac=1</label>
			<nail x="-37281" y="-365"/>
			<nail x="-38088" y="-365"/>
		</transition>
		<transition>
			<source ref="id63"/>
			<target ref="id60"/>
			<label kind="select" x="-37255" y="-527">e:id_n</label>
			<label kind="guard" x="-37255" y="-510">works[e-1]==0</label>
			<label kind="assignment" x="-37204" y="-527">n=e</label>
		</transition>
		<transition>
			<source ref="id61"/>
			<target ref="id63"/>
			<label kind="guard" x="-37340" y="-535">i==0</label>
			<label kind="assignment" x="-37357" y="-510">inquene(i)</label>
		</transition>
		<transition>
			<source ref="id61"/>
			<target ref="id62"/>
			<label kind="guard" x="-37561" y="-467">i!=0</label>
			<nail x="-37374" y="-467"/>
			<nail x="-37714" y="-467"/>
		</transition>
		<transition>
			<source ref="id62"/>
			<target ref="id61"/>
			<label kind="guard" x="-37706" y="-535">time[i-1]&gt;=deadtime[tquene[i-1]]-deadtime[rank]</label>
			<label kind="assignment" x="-37689" y="-510">nquene[i]=nquene[i-1],tquene[i]=tquene[i-1],
time[i]=tquene[i-1],i=i-1</label>
		</transition>
		<transition>
			<source ref="id62"/>
			<target ref="id63"/>
			<label kind="guard" x="-37680" y="-595">time[i-1]&lt;deadtime[tquene[i-1]]-deadtime[rank]</label>
			<label kind="assignment" x="-37595" y="-569">inquene(i)</label>
			<nail x="-37723" y="-569"/>
			<nail x="-37324" y="-569"/>
		</transition>
		<transition>
			<source ref="id59"/>
			<target ref="id63"/>
			<label kind="guard" x="-37621" y="-654">tail==0</label>
			<label kind="assignment" x="-37561" y="-654">inquene(tail)</label>
			<nail x="-37723" y="-629"/>
			<nail x="-37315" y="-629"/>
		</transition>
		<transition>
			<source ref="id65"/>
			<target ref="id64"/>
			<label kind="select" x="-38046" y="-612">e:id_p</label>
			<label kind="synchronisation" x="-38054" y="-595">mess_HP[e]?</label>
			<label kind="assignment" x="-38063" y="-578">paitent=e,rank=2,iniac=0</label>
			<nail x="-38071" y="-578"/>
			<nail x="-37944" y="-578"/>
		</transition>
		<transition>
			<source ref="id65"/>
			<target ref="id64"/>
			<label kind="select" x="-38020" y="-671">e:id_p</label>
			<label kind="synchronisation" x="-38037" y="-654">mess_ins[e]?</label>
			<label kind="assignment" x="-38046" y="-629">paitent=e,rank=0,iniac=0</label>
			<nail x="-38063" y="-629"/>
			<nail x="-37935" y="-629"/>
		</transition>
		<transition>
			<source ref="id65"/>
			<target ref="id64"/>
			<label kind="select" x="-38046" y="-510">e:id_p</label>
			<label kind="synchronisation" x="-38054" y="-493">mess_ine[e]?</label>
			<label kind="assignment" x="-38071" y="-476">paitent=e,rank=1,iniac=0</label>
			<nail x="-38097" y="-476"/>
			<nail x="-37944" y="-476"/>
		</transition>
		<transition>
			<source ref="id65"/>
			<target ref="id64"/>
			<label kind="select" x="-38054" y="-561">e:id_p</label>
			<label kind="synchronisation" x="-38063" y="-544">mess_MP[e]?</label>
			<label kind="assignment" x="-38105" y="-527">paitent=e,rank=3,iniac=0</label>
		</transition>
	</template>
	<template>
		<name>TH</name>
		<parameter>const id_n idn</parameter>
		<declaration>/**流程的正确性验证指标**/
clock testc;
/**护士设定**/
const int ins_ts=2;//护士扎针
const int ins_te=3;
const int ine_ts=2; //护士拔针
const int ine_te=4;
const int hp_ts=10;//护士处理高级警报
const int hp_te=15;
const int mp_ts=5;//护士处理中级警报
const int mp_te=7;
const int other_ts=9;//护士处理其他信息
const int other_te=10;
/**辅助**/
clock clnn;
int patient,rank;
bool ac;
</declaration>
		<location id="id66" x="-12027" y="-1063">
			<name x="-12012" y="-1097">help5</name>
			<committed/>
		</location>
		<location id="id67" x="-12010" y="-782">
			<name x="-12020" y="-816">help4</name>
			<committed/>
		</location>
		<location id="id68" x="-12010" y="-841">
			<name x="-12020" y="-875">help3</name>
			<committed/>
		</location>
		<location id="id69" x="-12010" y="-909">
			<name x="-12020" y="-943">help2</name>
			<committed/>
		</location>
		<location id="id70" x="-12019" y="-986">
			<name x="-12029" y="-1020">help1</name>
			<committed/>
		</location>
		<location id="id71" x="-11551" y="-986">
			<name x="-11534" y="-995">end</name>
			<committed/>
		</location>
		<location id="id72" x="-12188" y="-842">
			<name x="-12265" y="-875">station</name>
			<committed/>
		</location>
		<location id="id73" x="-11840" y="-841">
			<name x="-11857" y="-875">hpbegin</name>
			<label kind="invariant" x="-11882" y="-833">clnn&lt;=hp_te</label>
		</location>
		<location id="id74" x="-11840" y="-986">
			<name x="-11850" y="-1020">inebegin</name>
			<label kind="invariant" x="-11866" y="-978">clnn&lt;=ine_te</label>
		</location>
		<location id="id75" x="-11840" y="-782">
			<name x="-11865" y="-816">mpbegin</name>
			<label kind="invariant" x="-11882" y="-773">clnn&lt;=mp_te</label>
		</location>
		<location id="id76" x="-11832" y="-909">
			<name x="-11842" y="-943">insbegin</name>
			<label kind="invariant" x="-11875" y="-901">clnn&lt;=ins_te</label>
		</location>
		<location id="id77" x="-12529" y="-841">
			<name x="-12539" y="-875">start</name>
		</location>
		<location id="id78" x="-11840" y="-1063">
			<name x="-11874" y="-1097">othersbegin</name>
			<label kind="invariant" x="-11883" y="-1054">clnn&lt;=other_te</label>
		</location>
		<init ref="id77"/>
		<transition>
			<source ref="id72"/>
			<target ref="id66"/>
			<label kind="guard" x="-12087" y="-1037">rank==4</label>
		</transition>
		<transition>
			<source ref="id77"/>
			<target ref="id69"/>
			<label kind="synchronisation" x="-12401" y="-978">holdon[patient]?</label>
			<label kind="assignment" x="-12435" y="-952">ini1[idn-1]=0,works[idn-1]=1</label>
			<nail x="-12469" y="-952"/>
			<nail x="-12010" y="-952"/>
		</transition>
		<transition>
			<source ref="id71"/>
			<target ref="id77"/>
			<label kind="guard" x="-12342" y="-705">!ac</label>
			<label kind="synchronisation" x="-12291" y="-705">over[patient]!</label>
			<label kind="assignment" x="-12155" y="-705">works[idn-1]=0,ini1[idn-1]=1,testc=0</label>
			<nail x="-11526" y="-909"/>
			<nail x="-11534" y="-688"/>
			<nail x="-12588" y="-688"/>
		</transition>
		<transition>
			<source ref="id71"/>
			<target ref="id77"/>
			<label kind="guard" x="-12342" y="-739">ac</label>
			<label kind="synchronisation" x="-12291" y="-739">over1[patient]!</label>
			<label kind="assignment" x="-12155" y="-739">works[idn-1]=0,ini1[idn-1]=1,testc=0</label>
			<nail x="-11568" y="-722"/>
			<nail x="-12520" y="-722"/>
		</transition>
		<transition>
			<source ref="id72"/>
			<target ref="id67"/>
			<label kind="guard" x="-12129" y="-807">rank==3</label>
			<nail x="-12138" y="-782"/>
		</transition>
		<transition>
			<source ref="id69"/>
			<target ref="id76"/>
			<label kind="synchronisation" x="-11976" y="-926">inss[patient]!</label>
			<label kind="assignment" x="-11967" y="-909">clnn=0</label>
			<nail x="-11874" y="-909"/>
		</transition>
		<transition>
			<source ref="id72"/>
			<target ref="id68"/>
			<label kind="guard" x="-12112" y="-868">rank==2</label>
		</transition>
		<transition>
			<source ref="id72"/>
			<target ref="id69"/>
			<label kind="guard" x="-12095" y="-926">rank==0</label>
			<nail x="-12069" y="-909"/>
		</transition>
		<transition>
			<source ref="id70"/>
			<target ref="id74"/>
			<label kind="synchronisation" x="-11959" y="-1003">ines[patient]!</label>
			<label kind="assignment" x="-11951" y="-986">clnn=0</label>
		</transition>
		<transition>
			<source ref="id75"/>
			<target ref="id71"/>
			<label kind="guard" x="-11798" y="-799">clnn&gt;=mp_ts</label>
			<label kind="synchronisation" x="-11806" y="-782">mpe[patient]!</label>
			<label kind="assignment" x="-11798" y="-816">clnn=0</label>
			<nail x="-11696" y="-782"/>
		</transition>
		<transition>
			<source ref="id73"/>
			<target ref="id71"/>
			<label kind="guard" x="-11806" y="-858">clnn&gt;=hp_ts</label>
			<label kind="synchronisation" x="-11806" y="-841">hpe[patient]!</label>
			<label kind="assignment" x="-11781" y="-875">clnn=0</label>
			<nail x="-11704" y="-841"/>
		</transition>
		<transition>
			<source ref="id74"/>
			<target ref="id71"/>
			<label kind="guard" x="-11832" y="-1037">clnn&gt;=ine_ts</label>
			<label kind="synchronisation" x="-11704" y="-1003">inee[patient]!</label>
			<label kind="assignment" x="-11781" y="-1003">clnn=0</label>
		</transition>
		<transition>
			<source ref="id76"/>
			<target ref="id71"/>
			<label kind="guard" x="-11789" y="-934">clnn&gt;=ins_ts</label>
			<label kind="synchronisation" x="-11798" y="-909">inse[patient]!</label>
			<label kind="assignment" x="-11772" y="-951">clnn=0</label>
			<nail x="-11704" y="-909"/>
		</transition>
		<transition>
			<source ref="id77"/>
			<target ref="id72"/>
			<label kind="synchronisation" x="-12410" y="-867">deal[idn]?</label>
			<label kind="assignment" x="-12503" y="-833">clnn=0,works[idn-1]=1,rank=typests,
patient=numbersts,ini1[idn-1]=0,ac=acntn,acntn=0</label>
		</transition>
		<transition>
			<source ref="id68"/>
			<target ref="id73"/>
			<label kind="synchronisation" x="-11985" y="-841">hps[patient]!</label>
			<label kind="assignment" x="-11968" y="-867">clnn=0</label>
		</transition>
		<transition>
			<source ref="id72"/>
			<target ref="id70"/>
			<label kind="guard" x="-12087" y="-1011">rank==1</label>
			<nail x="-12053" y="-986"/>
		</transition>
		<transition>
			<source ref="id67"/>
			<target ref="id75"/>
			<label kind="synchronisation" x="-12027" y="-774">mps[patient]!</label>
			<label kind="assignment" x="-12002" y="-799">clnn=0</label>
		</transition>
		<transition>
			<source ref="id78"/>
			<target ref="id71"/>
			<label kind="guard" x="-11814" y="-1080">clnn&gt;=other_ts</label>
			<label kind="synchronisation" x="-11712" y="-1080">othere[patient]!</label>
			<label kind="assignment" x="-11610" y="-1080">clnn=0</label>
			<nail x="-11551" y="-1063"/>
		</transition>
		<transition>
			<source ref="id66"/>
			<target ref="id78"/>
			<label kind="synchronisation" x="-11993" y="-1080">others[patient]!</label>
			<label kind="assignment" x="-11967" y="-1063">clnn=0</label>
		</transition>
	</template>
	<template>
		<name>AD</name>
		<parameter>const id_n idn</parameter>
		<declaration>/**参数设定**/
const int n2=100;
/**衡量指标**/
/**辅助**/
bool rep[nn];//作为对照
int rank,paitent;
int rank1=-1,patient1;
bool ac;
int list[n2];//病人
int ranklist[n2];//类型
int rank1list[n2];
int tailn=0; //队尾
void inquene(int num,int rank){
    int i,t,j,rank2;
     int k=0;
     rank2=rank;
    if(tailn==n2)
    {
        for(i=0;i&lt;tailn-1;i++)
        {
            list[i]=list[i+1];
            ranklist[i]=ranklist[i+1];
            rank1list[i]=rank1list[i+1];
        }
        list[tailn-1]=0;
        ranklist[tailn-1]=0;
        rank1list[tailn-1]=0;
        tailn=tailn-1;
        lost=lost+1;
     };//只能记住两个，三个以上就记不住了。
    for(i=0;i&lt;tailn;i++)
    {
     if (list[i]==num and ranklist[i]==rank)
        {
            for(j=i;j&lt;tailn;j++)
            {
            list[i]=list[i+1];
            ranklist[i]=ranklist[i+1];
            rank1list[i]=rank1list[i+1];
            }
        tailn=tailn-1;
        rank2=rank;
        rank=rank+1;
        }   
    };//如果有重复的消息，则先把之前的那个去掉，然后把这个的优先级加一放进去。
     for(t=tailn-1;t&gt;=-1;t--)
    {
        if(k==0 and (t==-1 or ranklist[t]&lt;rank)) 
        {
            ranklist[t+1]=rank;
            rank1list[t+1]=rank2;
            list[t+1]=num;
            k = 1;     
        }
        if(t!=-1 and ranklist[t]&gt;=rank) 
        {
            ranklist[t+1]=ranklist[t];
            rank1list[t+1]=rank1list[t];
            list[t+1]=list[t];
        } 
    }//加进去新消息以后排优先级  
    tailn=tailn+1;
}
void outpush(){
list[tailn-1]=0;
ranklist[tailn-1]=0;
rank1list[tailn-1]=0;
tailn--;
}
void outauto(){
rank1=-1;
}</declaration>
		<location id="id79" x="-7369" y="-246">
			<name x="-7412" y="-229">start</name>
		</location>
		<location id="id80" x="-6315" y="-238">
			<name x="-6325" y="-272">out</name>
			<committed/>
		</location>
		<location id="id81" x="-6034" y="-365">
			<name x="-6044" y="-399">waitereply</name>
			<committed/>
		</location>
		<location id="id82" x="-6315" y="-365">
			<name x="-6325" y="-399">decidecon</name>
			<committed/>
		</location>
		<init ref="id79"/>
		<transition>
			<source ref="id80"/>
			<target ref="id79"/>
			<label kind="guard" x="-7165" y="-153">!works[idn-1]&amp;&amp;tailn&gt;0&amp;&amp;ini1[idn-1]&amp;&amp;rank1==rank1list[tailn-1]&amp;&amp;patient1==list[tailn-1]</label>
			<label kind="synchronisation" x="-7164" y="-128">deal[idn]!</label>
			<label kind="assignment" x="-7046" y="-127">numbersts=patient1,typests=rank1,acntn=1,ini[idn-1]=1,outpush(),outauto()</label>
			<nail x="-6476" y="-102"/>
			<nail x="-7266" y="-102"/>
		</transition>
		<transition>
			<source ref="id80"/>
			<target ref="id79"/>
			<label kind="guard" x="-7207" y="-187">works[idn-1]||(tailn==0&amp;&amp;rank1==-1)||!ini1[idn-1]</label>
			<label kind="assignment" x="-6791" y="-187">ini[idn-1]=1</label>
			<nail x="-6536" y="-161"/>
			<nail x="-7190" y="-161"/>
		</transition>
		<transition>
			<source ref="id82"/>
			<target ref="id79"/>
			<label kind="guard" x="-7071" y="-433">rank==5</label>
			<label kind="synchronisation" x="-6910" y="-433">overtalk[paitent]!</label>
			<label kind="assignment" x="-6774" y="-433">ini[idn-1]=1</label>
			<nail x="-6391" y="-408"/>
			<nail x="-7241" y="-408"/>
		</transition>
		<transition>
			<source ref="id79"/>
			<target ref="id80"/>
			<label kind="select" x="-6969" y="-229">e:id_p</label>
			<label kind="synchronisation" x="-6893" y="-229">over[e]?</label>
			<label kind="assignment" x="-6791" y="-229">ini[idn-1]=0</label>
			<nail x="-7190" y="-204"/>
			<nail x="-6578" y="-204"/>
		</transition>
		<transition>
			<source ref="id80"/>
			<target ref="id79"/>
			<label kind="guard" x="-7156" y="-34">!works[idn-1]&amp;&amp;ini1[idn-1]&amp;&amp;((tailn==0&amp;&amp;rank1!=-1)||(tailn&gt;0&amp;&amp;rank1&gt;ranklist[tailn-1]))</label>
			<label kind="synchronisation" x="-7156" y="-8">deal[idn]!</label>
			<label kind="assignment" x="-6995" y="-8">numbersts=patient1,typests=rank1,acntn=1,ini[idn-1]=1,outauto()</label>
			<nail x="-6408" y="17"/>
			<nail x="-7301" y="17"/>
		</transition>
		<transition>
			<source ref="id80"/>
			<target ref="id79"/>
			<label kind="guard" x="-7284" y="-94">!works[idn-1]&amp;&amp;tailn!=0&amp;&amp;ini1[idn-1]&amp;&amp;(rank1==-1||(rank1&lt;=ranklist[tailn-1]&amp;&amp;rank1!=rank1list[tailn-1])||(rank1&lt;=ranklist[tailn-1]&amp;&amp;patient1!=list[tailn-1]))</label>
			<label kind="synchronisation" x="-7165" y="-68">deal[idn]!</label>
			<label kind="assignment" x="-7020" y="-68">numbersts=list[tailn-1],typests=ranklist[tailn-1],ini[idn-1]=1,outpush()</label>
			<nail x="-6459" y="-51"/>
			<nail x="-7284" y="-51"/>
		</transition>
		<transition>
			<source ref="id79"/>
			<target ref="id80"/>
			<label kind="synchronisation" x="-6910" y="-348">mess_out[idn]?</label>
			<label kind="assignment" x="-6774" y="-348">rank1=typectn,patient1=numberctn,ini[idn-1]=0</label>
			<nail x="-7164" y="-323"/>
			<nail x="-6493" y="-323"/>
		</transition>
		<transition>
			<source ref="id81"/>
			<target ref="id80"/>
			<label kind="guard" x="-6187" y="-263">reply==rep</label>
			<label kind="assignment" x="-6213" y="-238">inquene(paitent,rank)</label>
			<nail x="-6034" y="-238"/>
		</transition>
		<transition>
			<source ref="id81"/>
			<target ref="id79"/>
			<label kind="guard" x="-7080" y="-484">reply!=rep</label>
			<label kind="assignment" x="-6689" y="-484">ini[idn-1]=1,reply=rep</label>
			<nail x="-6034" y="-459"/>
			<nail x="-7343" y="-459"/>
		</transition>
		<transition>
			<source ref="id82"/>
			<target ref="id80"/>
			<label kind="guard" x="-6366" y="-323">rank!=5&amp;&amp;tailn&lt;n2</label>
			<label kind="assignment" x="-6366" y="-306">inquene(paitent,rank)</label>
		</transition>
		<transition>
			<source ref="id79"/>
			<target ref="id80"/>
			<label kind="guard" x="-7174" y="-297">!works[idn-1]&amp;&amp;tailn==0</label>
			<label kind="synchronisation" x="-6987" y="-297">transcall?</label>
			<label kind="assignment" x="-6919" y="-297">reply[idn-1]=1,paitent=numberntn,rank=typentn,ini[idn-1]=0,inquene(paitent,rank)</label>
			<nail x="-7173" y="-272"/>
			<nail x="-6468" y="-272"/>
		</transition>
		<transition>
			<source ref="id82"/>
			<target ref="id81"/>
			<label kind="guard" x="-6255" y="-391">rank!=5&amp;&amp;tailn&gt;=n2</label>
			<label kind="synchronisation" x="-6128" y="-391">transcall!</label>
			<label kind="assignment" x="-6272" y="-357">numberntn=paitent,typentn=rank</label>
		</transition>
		<transition>
			<source ref="id79"/>
			<target ref="id82"/>
			<label kind="synchronisation" x="-6910" y="-391">connect[idn]?</label>
			<label kind="assignment" x="-6774" y="-391">rank=typeptn,paitent=numberptn,ini[idn-1]=0</label>
			<nail x="-7216" y="-365"/>
			<nail x="-6442" y="-365"/>
		</transition>
		<transition>
			<source ref="id79"/>
			<target ref="id80"/>
			<label kind="select" x="-6969" y="-263">e:id_p</label>
			<label kind="synchronisation" x="-6901" y="-263">over1[e]?</label>
			<label kind="assignment" x="-6799" y="-263">ini[idn-1]=0</label>
		</transition>
	</template>
	<system>// Place template instantiations here.
//Process = Template();
// List one or more processes to be composed into a system.
system Minject,Mbreath,Mblood,Pinject,Pbreath,Pblood,Purgent,Pask,AC,TH,AD,BEGIN;</system>
	<queries>
		<query>
			<formula>simulate 1 [&lt;=1440] {works[0] ,AC.tail}
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>Pr[&lt;=1440] (&lt;&gt;works[0]==1 and works[1]==1 and TH(1).patient==TH(2).patient)
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>E[ &lt;=1440; 400](max:Pask(1).endask==Pask(1).startask)
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>E[ &lt;=1440;400](max:Pask(1).startask)
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>simulate 10 [&lt;=1440] {Pask(1).endask,Pask(1).startask}
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>E[ &lt;=1440; 400](max:Purgent(1).endother)
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>E[ &lt;=1440;400](max:Purgent(1).startother)
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>simulate 10 [&lt;=1440] {Purgent(1).endother,Purgent(1).startother}
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>E[ &lt;=1440; 400](max:Mblood(1).endmp)
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>E[ &lt;=1440; 400](max:Pblood(1).endmp)
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>E[ &lt;=1440;400](max:Pblood(1).startmp)
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>simulate 10 [&lt;=1440] {Mblood(1).endmp,Pblood(1).endmp,Pblood(1).startmp}
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>E[ &lt;=1440; 400](max:Mbreath(1).endhp)
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>E[ &lt;=1440; 400](max:Pbreath(1).endhp)
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>E[ &lt;=1440;400](max:Pbreath(1).starthp)
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>simulate 10 [&lt;=1440] {Mbreath(1).endhp,Pbreath(1).endhp,Pbreath(1).starthp}
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>E[ &lt;=1440; 20](max:Pinject(1).startins)
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>Pr[&lt;=1440] ([]Pinject(1).startins&lt;=2)
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>E[ &lt;=1440; 20](max:Pinject(1).endins)
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>Pr[&lt;=1440] ([]Pinject(1).endins&lt;=2)
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>Pr[&lt;=1440] ([]Minject(1).endins&lt;=2)
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>E[ &lt;=1440; 20](max:Minject(1).endins)
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>Pr[&lt;=1440] ([]Minject(1).startins&lt;=2)
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>simulate 10 [&lt;=1440] {Pinject(1).startins,Pinject(1).endins,Minject(1).startins,Minject(1).endins}
			</formula>
			<comment>
			</comment>
		</query>
		<query>
			<formula>E[ &lt;=1440; 20](max:Minject(1).startins)
			</formula>
			<comment>
			</comment>
		</query>
	</queries>
</nta>
